\documentclass[11pt, a4paper]{article}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{geometry}
\geometry{a4paper, margin=1in}

\title{On the Construction of Monomial Nikodym Sets}
\author{}
\date{}

\begin{document}
\maketitle

\begin{abstract}
We revisit a construction of Nikodym sets in $\mathbb{F}_p^3$ based on the removal of monomial surfaces. We provide a rigorous proof, contingent on standard but deep results regarding Galois groups of polynomials over function fields, that this construction yields a valid Nikodym set when its defining parameter $k$ grows logarithmically with the characteristic $p$. Specifically, $k < \log p - \log(\log p)$. We analyze the size of the resulting set, showing it to be $|N| \approx p^3 - 2(1-\epsilon)p^2 \log p$. We determine that the constant of proportionality in this size estimate can be made arbitrarily close to 2.
\end{abstract}

\section{Introduction}
A Nikodym set $N \subset \mathbb{F}_p^3$ is a set such that for every point $P \in \mathbb{F}_p^3$, there exists a line $L$ containing $P$ for which $L \setminus \{P\} \subset N$. We analyze the construction $N_k = \mathbb{F}_p^3 \setminus C_k$, where $C_k$ is the union of surfaces $S_d = \{(x,y,z) \in (\mathbb{F}_p^*)^3 \mid z/y = x^d \}$ for $d \in D_k = \{\pm 1, \dots, \pm k\}$. Here, we employ a more powerful algebraic and probabilistic argument to establish a bound on $k$ that allows for a non-trivial growth rate, leading to a sparser Nikodym set than constructions with fixed $k$.

\section{Explanation of the Construction}
The set $N$ is constructed in the 3-dimensional vector space over the finite field $\mathbb{F}_p$, denoted $\mathbb{F}_p^3$. The strategy is to define a complementary set $C$ and set $N = \mathbb{F}_p^3 \setminus C$.

The set $C$ is defined as the union of parameterized monomial curves:
$$ C = \{ (t, t^k \pmod p, t^{k+d} \pmod p) \mid t \in \mathbb{F}_p^*, k \in \{1, \dots, p-1\}, d \in D \} $$
where $\mathbb{F}_p^* = \{1, \dots, p-1\}$ and $D$ is the set $\{-4, -3, -2, -1, 1, 2, 3, 4\}$.
Since $t \neq 0$, the set $C$ is entirely contained within the multiplicative torus $(\mathbb{F}_p^*)^3$.

\subsection{Algebraic Characterization}
A point $(x,y,z) \in (\mathbb{F}_p^*)^3$ is in $C$ if and only if there exist $t, k, d$ satisfying the parameterization. This implies $x=t, y=t^k, z=t^{k+d}$, so $z/y = t^d = x^d$. Conversely, if $z/y = x^d$, we can set $t=x$ and find $k$ such that $y=x^k$ (the discrete logarithm).

Therefore, $C$ is the union of 8 algebraic surfaces $S_d$ restricted to $(\mathbb{F}_p^*)^3$:
$$ C = \bigcup_{d \in D} S_d, \quad \text{where } S_d = \{ (x,y,z) \in (\mathbb{F}_p^*)^3 \mid z/y = x^d \} $$
The algebraic degree of the surface $S_d$ is $|d|+1$, ranging from 2 to 5.

\subsection{Formula for the Size of N}
We calculate the size of $N$ as $|N| = p^3 - |C|$. We use the Principle of Inclusion-Exclusion to determine $|C|$. The size of each surface is $|S_d| = (p-1)^2$, as $x$ and $y$ can be chosen independently in $\mathbb{F}_p^*$, and $z$ is determined.

The intersection of two distinct surfaces $S_{d_1} \cap S_{d_2}$ requires $x^{d_1} = x^{d_2} \implies x^{d_1-d_2} = 1$. The number of solutions for $x$ is $g = \text{gcd}(d_1-d_2, p-1)$. Since the maximum difference is 8, $g \le 8$. The size of the intersection is $g(p-1)$.

\textbf{Asymptotic Size:}
$$ |C| = \sum |S_d| - \sum |S_{d_1} \cap S_{d_2}| + \dots = 8(p-1)^2 - O(p) = 8p^2 + O(p) $$
The size of the constructed set is:
$$ |N| = p^3 - 8p^2 + O(p) $$

\section{Main Result and Proof}

\subsection{Main Theorem}
Our central theorem establishes the logarithmic relationship between the parameter $k$ and the prime $p$.
\newtheorem*{theorem}{Theorem 2.1}
\begin{theorem}
Let the set $N_k$ be defined as above. There exists a constant $p_0$ such that for all primes $p > p_0$, if $k$ satisfies
$$ k < \log p - \log(\log p), $$
then $N_k$ is a Nikodym set.
\end{theorem}
This theorem directly leads to a conclusion about the size of the constructed set.
\newtheorem*{corollary}{Corollary 2.2}
\begin{corollary}
For a choice of $k = \lfloor \log p - \log(\log p) - 1 \rfloor$, the constructed Nikodym set $N_k$ has a size of approximately
$$ |N_k| = p^3 - 2p^2 \log p + O(p^2 \log(\log p)). $$
\end{corollary}

\subsection{Proof of the Main Theorem}
The proof is trivial for points $P$ with a zero coordinate, as $C_k \subset (\mathbb{F}_p^*)^3$. We therefore consider a generic point $P=(a,b,c) \in (\mathbb{F}_p^*)^3$. We wish to show there exists a line $L(t) = P+tV$ through $P$ that does not intersect $C_k$ for any $t \neq 0$.

A direction $V=(u,v,w)$ is "bad" if for some $d \in D_k$, the line $L(t)$ intersects the surface $S_d$ at some $t \in \mathbb{F}_p^*$. The intersection condition is given by the polynomial equation $E_d(t;V)=0$, where for $d>0$:
$$ (c+tw) = (b+tv)(a+tu)^d $$
This is a polynomial in $t$ of degree at most $D_d = |d|+1$. A direction $V$ is "good" if for all $d \in D_k$, the polynomial $E_d(t;V)$ has no roots in $\mathbb{F}_p$.

\subsection{Probabilistic Argument via Galois Theory}
We treat $E_d(t;V)$ as a polynomial in $t$ whose coefficients are polynomials in the coordinates of $V$. This is a polynomial over the function field $\mathbb{F}_p(V) = \mathbb{F}_p(u,v,w)$. The behavior of the roots of $E_d(t;V)$ as $V$ is specialized to values in $\mathbb{F}_p^3$ is governed by the Galois group of $E_d$ over $\mathbb{F}_p(V)$.
\begin{enumerate}
    \item \textbf{Galois Theory:} It is a standard, though profound, result in algebraic geometry (a consequence of Hilbert's Irreducibility Theorem) that for a generic choice of point $P$, the polynomial $E_d(t;V)$ is irreducible over $\mathbb{F}_p(V)$ and its Galois group is the full symmetric group, $\text{Gal}(E_d/\mathbb{F}_p(V)) \cong S_{D_d}$.
    \item \textbf{Chebotarev Density Theorem:} The Chebotarev density theorem for function fields relates the statistical distribution of the factorization patterns of the specialized polynomials $E_d(t;V)$ to the distribution of cycle structures in the Galois group. Specifically, the proportion of directions $V \in \mathbb{F}_p^3$ for which $E_d(t;V)$ has a given factorization pattern (e.g., no roots) is equal to the proportion of elements in the Galois group $S_{D_d}$ with the corresponding cycle structure (e.g., being a derangement).
    \item \textbf{Probability of No Roots:} A polynomial has no roots in $\mathbb{F}_p$ if its Galois group action on the roots has no fixed points. The proportion of such elements in $S_n$ is the ratio of derangements to the size of the group, which is well-approximated by $1/e$. Let $\delta(n)$ be this proportion.
    $$ \delta(n) = \frac{1}{n!} \sum_{i=0}^{n-1} \frac{(-1)^i}{i!} $$
    For $n \ge 2$, we have $1/3 < \delta(n) < 1/2$. As $n \to \infty$, $\delta(n) \to 1/e$.
    \item \textbf{Independence:} We make a further standard assumption: for a generic $P$, the polynomials $\{E_d(t;V)\}_{d \in D_k}$ are algebraically independent in a suitable sense. This implies that their joint Galois group is the product of their individual Galois groups: $\prod_{d \in D_k} S_{D_d}$. Consequently, the probability of a direction being "good" (i.e., having no roots for any $d \in D_k$) is the product of the individual probabilities.
\end{enumerate}

\subsection{Bounding the Number of Good Directions, $N_{\text{good}}$}
The number of good directions, $N_{\text{good}}$, can be estimated. For large $p$, an effective version of the Chebotarev theorem gives:
$$ N_{\text{good}} \approx (p^2+p+1) \prod_{d \in D_k} \delta(D_d) $$
We need to show $N_{\text{good}} > 0$. It is sufficient to show that the product of probabilities is not too small.
$$ \prod_{d \in D_k} \delta(D_d) = \left(\prod_{d=1}^k \delta(d+1)\right)^2 $$
Since $\delta(n) \ge 1/3$ for $n \ge 2$, we have a lower bound:
$$ N_{\text{good}} \gtrsim p^2 \cdot (1/3)^{2k} $$
We need $p^2(1/3)^{2k} > 1$, which implies $p^2 > 3^{2k}$, or $k < \frac{\log p}{\log 3} \approx 0.91 \log p$.

To be more precise and get the bound in the theorem, we use $\delta(n) \approx 1/e$. We want $p^2 e^{-2k} \gtrsim 1$, which gives $k < \log p$. The error terms in the Chebotarev estimate and the approximation $\delta(n) \approx 1/e$ require a small safety margin. The number of bad directions is bounded by a sum of error terms, roughly $2k \cdot C \cdot D_{\max} \cdot p^{3/2}$. To ensure the main term $p^2 \prod \delta(D_d)$ dominates this error, we need to subtract a lower-order term from the bound on $k$. Taking $k < \log p - \log(\log p)$ is sufficient to absorb these error terms for large $p$.

This establishes that for $p > p_0$ and $k < \log p - \log(\log p)$, the number of good directions is positive, guaranteeing the existence of a Nikodym line. \qed

\subsection{Size Analysis and the Constant c}
The size of the constructed set is approximately $p^3 - |C_k|$.
$$ |C_k| = 2k(p-1)^2 - \text{Overlap Term} \approx 2kp^2 $$
If we choose $k = c \log p$, then $|N_k| \approx p^3 - 2cp^2 \log p$.
Our proof required $N_{\text{good}} > 0$. Let's refine the condition:
$$ (p^2+p+1) \prod_{d \in D_k} \delta(D_d) \ge 1 $$
Taking logs:
$$ \log(p^2+p+1) \ge \sum_{d \in D_k} \log\left(\frac{1}{\delta(d+1)}\right) = 2\sum_{d=1}^k \log\left(\frac{1}{\delta(d+1)}\right) $$
As $d \to \infty$, $\delta(d+1) \to 1/e$, so $\log(1/\delta(d+1)) \to \log(e) = 1$.
Therefore, for large $k$, the sum is approximately $\sum_{d=1}^k 2 \cdot 1 = 2k$.
The condition becomes $2 \log p \gtrsim 2k$, which implies $k \lesssim \log p$.
This means we can choose $k = (1-\epsilon)\log p$ for any small $\epsilon > 0$. In the formula for the size, this corresponds to
$$ |N_k| \approx p^3 - 2(1-\epsilon) p^2 \log p. $$
Therefore, as $p \to \infty$, we can make the constant of proportionality, $2c$, arbitrarily close to 2. The theoretical maximum for $c$ is 1.

\newpage

\section{Critique and Refinements}
This section provides a detailed review of the proof, identifying significant gaps and a critical flaw in the analysis of the error terms. It then presents corrections to address these issues.

\subsection{Initial Analysis of Gaps}
While the overall strategy is sound, several steps require more rigorous justification.
\begin{enumerate}
    \item \textbf{Gap 1 (Maximality):} The proof relies heavily on the assumption that for a generic $P$, the Galois groups of $E_d(t;V)$ are maximal ($S_{|d|+1}$). This is stated as "standard but deep results". While this is plausible, proving maximality for specific monomial surfaces requires substantial justification using techniques like monodromy arguments.
    \item \textbf{Gap 2 (Independence):} The assumption that the splitting fields of $E_d$ are linearly disjoint is crucial for the probabilistic calculation. This strong assumption also requires rigorous proof.
    \item \textbf{Gap 3 (Genericity):} The proof assumes $P$ is a "generic" point. A Nikodym set must work for every point. The proof needs to ensure that the required Galois properties hold uniformly for all $P \in (\mathbb{F}_p^*)^3$, or handle exceptional points separately. Additionally, points with zero coordinates must be addressed.
\end{enumerate}

\subsection{The Critical Flaw: Handling of Error Terms}
The most significant issue in the proof is the handling of error terms arising from the effective Chebotarev Density Theorem. The estimate for the number of good directions $N_{\text{good}}$ is approximated by the main term $M$ plus an associated error term $E$. To guarantee $N_{\text{good}} > 0$, we must have $M>E$.

Let's analyze the magnitudes using the claimed bound $k = \log p - \log(\log p)$.
The main term is $M \approx p^2 \prod \delta(D_d) \approx p^2 e^{-2k}$.
So, $M \approx p^2 e^{-2(\log p - \log(\log p))} = p^2 (p^{-2}) (\log p)^2 = (\log p)^2$.

The proof acknowledges the existence of error terms and suggests they are roughly bounded by $O(2k \cdot D_{\max} \cdot p^{3/2})$. Since $D_{\max} \approx k$, the error bound is $E = O(k^2 p^{3/2})$.
So, $E \approx O((\log p)^2 p^{3/2})$.

In this regime, the error term $E$ is vastly larger than the main term $M$ (by a factor of $p^{3/2}$). Therefore, the main term does not dominate the error term, and we cannot conclude that $N_{\text{good}} > 0$.

\subsection{Author's Correction on Error Terms}
The critique is rigorous and insightful. The heuristic argument suggesting a construction achieving $k \approx \log p$ is indeed invalidated by the analysis of the error terms. The fatal comparison is correct:

\begin{itemize}
    \item \textbf{Main Term (M):} $M = p^2 e^{-2k}$. For $k \approx \log p$, $M \approx (\log p)^2$.
    \item \textbf{Error Term (E):} The effective Chebotarev Density Theorem (related to the Lang-Weil estimates) includes an error term that depends on the complexity of the field extensions (e.g., the genus or the discriminant) and the size of the field. Standard bounds yield an error term roughly of the form $E = O(k^2 p^{3/2})$ in this context.
\end{itemize}
Clearly, $E$ is vastly larger than $M$ by a factor of $p^{3/2}$. The main term is completely swamped by the uncertainty of the error term.

\textbf{The Corrected Bound:}
As the critique correctly derives, to ensure $M > E$, we need:
$$ p^2 e^{-2k} > C \cdot k^2 p^{3/2} \quad (\text{for some constant } C) $$
$$ p^{1/2} > C \cdot k^2 e^{2k} $$
If we set $k = c \log p$, this requires $p^{1/2} > C(c \log p)^2 p^{2c}$. For large $p$, this implies $1/2 > 2c$, or $c < 1/4$. This contradicts the main theorem's claim that $k$ can be close to $\log p$ (i.e., $c \approx 1$).

The proposed strategy, even if all other assumptions hold, only rigorously supports a bound of $k < (1/4)\log p$.

\subsection{Assumptions on Galois Groups and Genericity}
The critique correctly identifies that the calculation of the main term relies on strong, unproven assumptions about the Galois groups (Maximality and Independence) and the uniformity of this behavior over the choice of point $P$ (Genericity).
\begin{itemize}
    \item \textbf{Maximality and Independence:} While the construction seems generic, rigorously proving these properties for this family of surfaces is a substantial undertaking. If the groups are not independent, the estimate for the joint probability of derangements is inaccurate.
    \item \textbf{Genericity and Scope:} The algebraic properties, including the structure of the Galois groups, depend on $P$. It is necessary to prove that the required conditions hold uniformly for all $P \in (\mathbb{F}_p^*)^3$. If these properties fail for certain points (e.g., points on the coordinate axes), the construction may not qualify as a Nikodym set.
\end{itemize}

\section{Conclusion}
The critique accurately demonstrates that the presented proof is incomplete and contains a critical flaw.
\begin{enumerate}
    \item \textbf{The Error Terms:} The application of the effective Chebotarev Density Theorem does not support the claimed logarithmic bound $k \approx \log p$. The error terms dominate the main term in this regime. To make the proof rigorous, a much tighter control over the error terms would be required.
    \item \textbf{Rigorous Bound:} The method rigorously supports only $k < (1/4)\log p$, assuming the other gaps (regarding Galois groups and uniformity) are filled. To achieve the desired bound $k \approx \log p$ using this strategy, one would require significantly tighter control over the error terms in the Chebotarev Density Theoremâ€”bounds that are generally not available for such complex and high-degree field extensions, as the complexity of the joint Galois extension grows very rapidly with $k$.
\end{enumerate}
Based on the current analysis, the main theorem is not proven.

\end{document}
